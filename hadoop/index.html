<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Hadoop - BQLDatabase</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Hadoop";
    var mkdocs_page_input_path = "hadoop/index.md";
    var mkdocs_page_url = "/hadoop/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> BQLDatabase</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cloud/">Cloud</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Hadoop</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#artificial-intelligence-on-a-hadoop-cluster">Artificial Intelligence on a Hadoop Cluster</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#objective">Objective</a></li>
        
            <li><a class="toctree-l3" href="#advantage">Advantage</a></li>
        
            <li><a class="toctree-l3" href="#naive-bayes-classification">Na誰ve Bayes Classification</a></li>
        
            <li><a class="toctree-l3" href="#components">Components</a></li>
        
            <li><a class="toctree-l3" href="#gaussian-naive-bayes">Gaussian Naive Bayes</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cloud/aws/">Amazon Web Services</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../relational/indexing/">Indexing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../relational/">Relational</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../relational/disk/">DiskManager</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../documentation/">Documentation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../relational/buffer/">BufferManager</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../relational/global/">GlobalManager</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">BQLDatabase</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Hadoop</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="artificial-intelligence-on-a-hadoop-cluster">Artificial Intelligence on a Hadoop Cluster</h1>
<h2 id="objective">Objective</h2>
<p>Deploying a Hadoop cluster is not the only objective of this project. We want to compute something with it. In order to explore the technical details of an actual implementation, a simple algorithm has been developed that can run on a Hadoop cluster of computers.</p>
<blockquote>
<p>Since this algorithm doesn't need that much compute power, executing it on a cloud cluster is for demonstration purposes</p>
</blockquote>
<h2 id="advantage">Advantage</h2>
<p>Thanks to Java and the portability of the Hadoop program developing Hadoop programs is hardware independant. Thus, executing this algorithm on a local machine or on a cloud cluster if only a line of code away.</p>
<p><a href="../cloud/">More documentation on the cloud computing is available here</a></p>
<h2 id="naive-bayes-classification">Na誰ve Bayes Classification</h2>
<p>Na誰ve Bayes Classification is a simple but yet powerful way to classify some objects. It's considered as a supervised machine learning algorithm. Based on the famous Bayes Theorem, it makes the final choice of class using probabilities. It's called <em>na誰ve</em> because a strong assumption is made: that the studied variables are independant.</p>
<p><a href="https://mrmint.fr/naive-bayes-classifier">Here is a simple but complete article about this algorithm</a></p>
<h2 id="components">Components</h2>
<h3 id="classification">Classification</h3>
<h4 id="static-methods">Static methods</h4>
<p>The <code>Classification</code> class is used as a library. It exposes static methods to be called by the mapper and reducer classes and performs statistical computation in order to isolate what is not part of a Bayes algorithm. Here is the list of methods exposed and their signature.</p>
<pre><code class="Java">static void BuildClassOutputTable(ArrayList&lt;Classification&gt; Co,String reduceKey);
static void BuildConditionalProbabilityOutput(ArrayList&lt;Classification&gt; Cop,String reduceKey);

static void BuildProbabilityTable(ArrayList&lt;Classification&gt; Co, ArrayList&lt;Classification&gt; Cop, &lt;Classification&gt; PTable);

static double GetConditionnalProbability(String attribute,String Class);
</code></pre>

<p>As we can, see the Bayes theorem is used. First, we build the probabilities of each class, then the conditional probabilities, and finaly build the whol probability table. When we want to compute a probability, we call <code>GetConditionnalProbability</code>.</p>
<h4 id="data-structure">Data structure</h4>
<p>The <code>Classification</code> is also used as a data structure. As we can see in the constructor, it can encapsulate some attributes like the <code>reducekey</code>.</p>
<pre><code class="Java">public Classification(String reducekey,double value) {
    this.reducekey = reducekey; // Sunny,yes
    this.value = value;
    String[] tmp = reducekey.split(&quot;,&quot;); 
    this.att = tmp[0]; // att[0]=Sunny
    this.Class = tmp[1]; // att[1]=Yes
}
</code></pre>

<p>Thus, we can store probabilities using Java polymorphism in the mapper and reducer classes. It's easier to manipulate in the rest of the algorithm. In this code sample, we can see the use of Java generics in order to type the ArrayLists content.</p>
<pre><code class="Java">static ArrayList&lt;Classification&gt; Co=new ArrayList&lt;&gt;(); // Class Output
static ArrayList&lt;Classification&gt; Cpo=new ArrayList&lt;&gt;(); // Conditional probability Output
static ArrayList&lt;Classification&gt; PTable = new ArrayList&lt;&gt;();
</code></pre>

<h3 id="classifier">Classifier</h3>
<p>The <code>Classifier</code> is the main class to be executed by Hadoop. It contains the <code>main</code> method that is the start of any Java program. This method sets up the context of the algorithm and its high level execution:</p>
<p>Selecting the data structure to manipulate (see the next section about the <code>Classification</code>)</p>
<pre><code class="Java">job.setJarByClass(Classifier.class);    
</code></pre>

<p>Selecting the mapper and reducer classes.</p>
<pre><code class="Java">job.setMapperClass(NaiveBayesMapper.class);
job.setReducerClass(NaiveBayesReducer.class);
</code></pre>

<p>Defining the I/O components. i.e how to read and write data. We can see that the method is chosen (Text), but the files are not yet defined.</p>
<pre><code class="Java">job.setInputFormatClass(TextInputFormat.class);
job.setOutputFormatClass(TextOutputFormat.class);
````

Finaly, we can select the proper files that contain the data to process. The first is the training set, the other is to write the final results.

```Java
FileInputFormat.addInputPath(job, new Path(args[0]));
FileOutputFormat.setOutputPath(job, new Path(args[1]));
</code></pre>

<h3 id="mapreduce">MapReduce</h3>
<p>Invented by Google, this pattern is an abstraction on how to manipulate data. First, the <em>Map</em> step aims to selecta part of our data to analyse. It can transform this part, but does not aggregate objects. Second, the <em>Reduce</em> step aims to aggregage the results of the <em>Map</em> step, in order to compute the final result.</p>
<h4 id="mapper">Mapper</h4>
<p>The mapping is an operation that applies a transformation on a list of objects. This transformation is applied on each object, and returns another list of the same size. This transformation can be a simple selection of a property of each object, but it can also apply a mathematical computation.</p>
<p>In our algorithm, the mapper is implemented by the <code>NaiveBayesMapper</code> class. By convention (for Hadoop), this class implements only one method called <code>map</code>. We can see that it calls static method from our <em>library</em> named <code>Classification</code>. The <code>Classifier</code> is our manipulated data structure.</p>
<pre><code class="Java">Classification.BuildConditionalProbabilityOutput(Classifier.Cpo, key);
Classification.BuildClassOutputTable(Classifier.Co, klass);
</code></pre>

<blockquote>
<p>In this concrete example, the mapper maps the dataset to a list of probabilities. These are the intermediate probabilities refered to in the Naive Bayes algorithm.</p>
</blockquote>
<h4 id="reducer">Reducer</h4>
<p>The reducing operation can now aggregage the transformations performed by the mapper. It allows our algorithm to output less values, i.e going through the whole dataset and get a final result.</p>
<p>In our algorithm, the reducer is implemented by the <code>NaiveBayesReducer</code> class. By convention (for Hadoop), this class implements only one method called <code>reduce</code>. We can see that it calls static methods from our <em>library</em> named <code>Classification</code>. The <code>Classifier</code>is our manipulated data structure.</p>
<pre><code class="Java">Classification.BuildProbabilityTable(Classifier.Co, Classifier.Cpo, Classifier.PTable);
posterior = posterior*Classification.GetConditionnalProbability(attributes[j], Classifier.Co.get(i).getclass());
</code></pre>

<blockquote>
<p>In this concrete example, the reducer uses the previously mapped probabilities to compute the final table, and thus get the conditional probability. That's the final output of the Naive Bayes algorithm, called the <em>model</em>. This model can be used to classify new objects.</p>
</blockquote>
<h2 id="gaussian-naive-bayes">Gaussian Naive Bayes</h2>
<p>When dealing with continuous data, the general algorithm stays the same, but the way we handle data need to be adapted. That's why some new classes are implemented, and the manipulated values does not represent the same thing as the discrete implementation.</p>
<h3 id="data-structures">Data structures</h3>
<p>First, we need to implement different data structures:</p>
<ul>
<li><code>Data</code></li>
<li><code>Statistics</code></li>
<li><code>Probability</code></li>
<li><code>GaussianDistribution</code></li>
</ul>
<p>These classes leverage the object oriented paradigm in order to encapsulate continuous data and expose methods to compute values such as the variance, the mean, etc.</p>
<h3 id="algorithm">Algorithm</h3>
<p>In order to manipulate continuous data, we also have to adapt the base algorithm implementation. Instead of using descrete values of our training examples, the algorithm will leverage the previously detailed data structures and work on the aggregated values such as variance, mean, etc.</p>
<pre><code class="Java">double P_Height = pdf(Double.parseDouble(att[0]),female.getHeigtMeans(),female.getHeigtVariance());
double P_Weight = pdf(Double.parseDouble(att[1]),female.getWeigtMeans(),female.getWeigtVariance());
double P_FootSize = pdf(Double.parseDouble(att[2]),female.getHeigtMeans(),female.getFootSizeVariance());

posterior=posterior*P_Height*P_Weight*P_FootSize;
</code></pre>

<p>The main behavior of the algorithm stays the same: we map &amp; reduce values. It's the manipulated values that changed. Instead of manipulating <em>raw</em> data as discrete values, we aggregate a continuous set of data in order to output discrete values to work on.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cloud/aws/" class="btn btn-neutral float-right" title="Amazon Web Services">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../cloud/" class="btn btn-neutral" title="Cloud"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../cloud/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../cloud/aws/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js"></script>
      <script src="../search/require.js"></script>
      <script src="../search/search.js"></script>

</body>
</html>
